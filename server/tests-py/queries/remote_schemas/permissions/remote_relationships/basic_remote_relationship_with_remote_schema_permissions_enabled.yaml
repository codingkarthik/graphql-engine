- description: add remote schema permission for the 'user' role
  url: /v1/query
  status: 200
  query:
    type: add_remote_schema_permissions
    args:
      remote_schema: my-remote-schema
      role: user
      definition:
        schema: |
          interface Communication {
            id: Int!
            msg: String!
          }

          type Message implements Communication {
            id: Int!
            name: String!
            msg: String!
            errorMsg: String
          }

          type User {
            user_id: Int
            gimmeText(text: String @preset(value: "x-hasura-gimme-text")): String
          }

          type Query {
            message(id: Int!) : Message
            user(user_id: Int!): User
          }

- description: Simple remote relationship query with remote schema permissions configured
  url: /v1/graphql
  status: 200
  headers:
    X-Hasura-Role: user
    X-Hasura-User-Id: '1'
  response:
    data:
      profiles:
        - id: 1
          messageBasic:
            name: alice
  query:
    query: |
      query {
        profiles {
          id
          messageBasic {
            name
          }
        }
      }

- description: Simple remote relationship query with remote schema permissions configured
  url: /v1/graphql
  status: 200
  headers:
    X-Hasura-Role: user
    X-Hasura-User-Id: '1'
    X-Hasura-Gimme-Text: 'world'
  response:
    data:
      profiles:
        - id: 1
          userBasic:
            name: alice
            gimmeText: borld
  query:
    query: |
      query {
        profiles {
          id
          userBasic {
            name
            gimmeText
          }
        }
      }
