- description: add remote schema permission for the 'user' role
  url: /v1/query
  status: 200
  query:
    type: add_remote_schema_permissions
    args:
      remote_schema: my-remote-schema
      role: user
      definition:
        schema: |
          type Query {
            hello: String
          }

- description:
    test to check that when the given role doesn't have access to the remote relationship joining field
    , it should not expose the remote relationship field in the schema
  url: /v1/graphql
  status: 200
  headers:
    X-Hasura-Role: user
    X-Hasura-User-Id: '1'
  response:
    errors:
      - extensions:
          path: $.selectionSet.profiles.selectionSet.messageBasic
          code: validation-failed
        message: "field \"messageBasic\" not found in type: 'profiles'"
  query:
    query: |
      query {
        profiles {
          id
          messageBasic {
            name
          }
        }
      }

- description: drop remote schema permission for the 'user' role
  url: /v1/query
  status: 200
  query:
    type: drop_remote_schema_permissions
    args:
      remote_schema: my-remote-schema
      role: user
